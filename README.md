<h1>Intensiv√£o de Python</h1> 

> Status do Projeto: :heavy_check_mark: Conclu√≠do

### T√≥picos 

:small_blue_diamond: [Descri√ß√£o do projeto](#descri√ß√£o-do-projeto)

:small_blue_diamond: [Funcionalidades](#funcionalidades)

:small_blue_diamond: [Objetivos](#objetivos)

:small_blue_diamond: [Pr√©-requisitos](#pr√©-requisitos)

:small_blue_diamond: [Como rodar a aplica√ß√£o](#como-rodar-a-aplica√ß√£o-arrow_forward)

:small_blue_diamond: [Desafio 01](#desafio-01)

:small_blue_diamond: [Desafio 01 Funcionando](#desafio-01-funcionando)

:small_blue_diamond: [Desafio 02](#desafio-02)

:small_blue_diamond: [Desafio 02 Funcionando](#desafio-02-funcionando)

:small_blue_diamond: [Desafio 03](#desafio-03)

:small_blue_diamond: [Desafio 03 Funcionando](#desafio-03-funcionando)

:small_blue_diamond: [Desafio 04](#desafio-04)

## Descri√ß√£o do projeto 

<p align="justify">
  Meu primeiro projeto usando o Jupyter Notebook e minha primeira experi√™ncia abordando temas como Automa√ß√£o De Sistemas e Processos, An√°lise De Dados, Automa√ß√£o Web, Busca de Informa√ß√µes e a Utiliza√ß√£o de Intelig√™ncia Artificial para uma Previs√£o de Vendas.
</p>

## Funcionalidades

:heavy_check_mark: Aula 01 - Automa√ß√£o de Sistemas e Processos com Python.

:heavy_check_mark: Aula 02 - An√°lise de dados com Python.

:heavy_check_mark: Aula 03 - Automa√ß√£o Web e Busca de Informa√ß√µes com Python.

:heavy_check_mark: Aula 04 - Projeto Ci√™ncia de Dados - Previs√£o de Vendas


## Objetivos

- `Aula 01`

Na primeira aula do Intensiv√£o do Python voc√™ vai aprender a criar um c√≥digo de automa√ß√£o de an√°lise de dados e elabora√ß√£o de
relat√≥rios do absoluto zero. Para isso, vamos passar por conceitos como:
- `Jupyter Notebook`
- `Vari√°veis, m√©todos`
- `Importa√ß√£o de bibliotecas`
- `Uso de bibliotecas (pyautogui, time, pandas e pyperclip)`
- `Enviar e-mails automaticamente`

Ap√≥s todos esses conhecimentos, seremos capazes de transformar uma tabela cheia de informa√ß√µes, nem um pouco f√°ceis de serem interpretadas, em uma ferramenta automatizada de gera√ß√£o e envio autom√°tico de relat√≥rios para um destinat√°rio pr√©-definido.

![image](https://user-images.githubusercontent.com/54343955/182050109-9da4cb8c-8ce8-405a-ac26-e74427784320.png)


##
- `Aula 02`

Na segunda aula do Intensiv√£o do Python voc√™ vai aprender a criar um c√≥digo de an√°lise de dados. No dia a dia das empresas,
√© muito comum d√∫vidas sobre os resultados da empresa. Um conceito que cada dia mais cresce nas empresas √© o data driven.
Basicamente, √© dizer que a√ß√µes s√£o tomadas com base nos dados e n√£o em achismos.
Aprenda como fazer uma super an√°lise do zero com os conceitos abaixo:
- `Importando dados de bases .csv`
- `Tratar dados usando a biblioteca Pandas`
- `Importa√ß√£o de bibliotecas`
- `Cria√ß√£o de gr√°ficos usando o plotly`

Ap√≥s todos esses conhecimentos, seremos capazes de transformar uma tabela cheia de informa√ß√µes, nem um pouco f√°ceis de serem
interpretadas em uma an√°lise super aprofundada que servir√£o de base para tomada de decis√£o da ger√™ncia. Tudo gra√ßas a voc√™! ‚ò∫

![image](https://user-images.githubusercontent.com/54343955/182050141-b0f397ac-e73d-4a1d-bdc0-e6534ebf89d0.png)

##
- `Aula 03`

Na terceira aula do Intensiv√£o Python, voc√™ vai aprender a criar um c√≥digo para automa√ß√£o de processos. No dia a dia das
empresas, √© muito comum que existam opera√ß√µes manuais que al√©m de extremamente repetitivas (chatas) s√£o suscet√≠veis a
erro visto que s√£o feitas manualmente. Vamos aprender como criar um c√≥digo com o qual voc√™ possa resolver esse problema
sem nem tocar no mouse ‚ò∫. Aprenda como fazer uma automa√ß√£o com integra√ß√£o web com os conceitos abaixo:
- `Importando bases de dados do Excel`
- `Jupyter Notebook`
- `Importando bibliotecas`
- `Webdriver`
- `Usando Selenium`

![image](https://user-images.githubusercontent.com/54343955/182050169-69bd2e75-9f39-4cef-8748-365d25fda79e.png)


Ap√≥s todos esse aprendizado, seremos capazes de transformar um processo extremamente repetitivo em processo autom√°tico e sem erros! Tudo gra√ßas a voc√™! ‚ò∫
##
- `Aula 04`

Na quarta aula do Intensiv√£o Python voc√™ vai aprender a criar um c√≥digo de ci√™ncia de dados para cria√ß√£o de um modelo de
previs√£o do absoluto zero. Para isso, vamos passar por conceitos como:
- `Jupyter Notebook`
- `Etapas de um projeto de Ci√™ncia de Dados`
- `Gr√°ficos usando Python`
- `Uso de bibliotecas`
- `Modelos de Intelig√™ncia Artificial`

Ap√≥s todos esses conhecimentos, seremos capazes detransformar uma tabela cheia de informa√ß√µes, nem um pouco f√°ceis de serem interpretadas em um modelo de previs√£o de Vendas utilizando Intelig√™ncia Artificial.

![image](https://user-images.githubusercontent.com/54343955/182050089-343b6aee-74a7-4fea-be04-27fe32f571c8.png)


## Pr√©-requisitos

- :warning: [Anaconda](https://www.anaconda.com/)
- :warning: [Jupyter Notebook](https://jupyter.org/)
- :warning: [Pandas](https://www.w3schools.com/python/pandas/default.asp)
- :warning: [Pyperclip](https://pypi.org/project/pyperclip/)
- :warning: [Selenium](https://www.selenium.dev/)
- :warning: [Webdriver](https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/)
- :warning: [Plotly](https://plotly.com/)
- :warning: [Matplotlib](https://matplotlib.org/)
- :warning: [Seaborn](http://seaborn.pydata.org/)
- :warning: [Scikit-learn](https://scikit-learn.org/stable/index.html)

## Como rodar a aplica√ß√£o :arrow_forward:

No terminal, clone o projeto: 

```
git clone https://github.com/Leocbm/Intensivao-De-Python.git
```
- V√° at√© o seu terminal, caso n√£o saiba basta pesquisar por 'git CMD' na barra de pesquisa:
<img src="https://user-images.githubusercontent.com/54343955/182642752-1fd19d66-3b1c-46c5-9882-873eb1c3b8fc.png" width="480">

- Navegue at√© a pasta desejada com o comando 'cd', exemplo se sua pasta estiver no Desktop:

``` 
cd Desktop/Pasta
```
- Na pasta, basta escrever o comando acima.
<img src="https://user-images.githubusercontent.com/54343955/182644414-aa4c1dc0-9c79-4472-8a1c-fcaedee9581e.png" width="580">

- Ou se preferir pode utilizar o terminal da pr√≥pria IDE/Editor de c√≥digos:
- Exemplo usando o terminal do Jupyter:
<img src="https://user-images.githubusercontent.com/54343955/182663195-e6861872-0537-4b01-8782-82f5d9ec912d.png" width="880">

- Pronto! üòÑ
- Lembre-se de ter o <a href="https://git-scm.com/">git</a> instalado.

## Desafio 01

Para in√≠cio, nos deparamos com o seguinte desafio:

- `Desafio`: Todos os dias, o nosso sistema atualiza as vendas do dia anterior. O seu trabalho di√°rio, como analista, √© enviar um e-mail para a diretoria, assim que come√ßar a trabalhar, com o faturamento e a quantidade de produtos vendidos no dia anterior.

- E-mail da diretoria: seugmail+diretoria@gmail.com
- Local onde o sistema disponibiliza as vendas do dia anterior: https://drive.google.com/drive/folders/149xknr9JvrlEnhNWO49zPcw0PW5icxga?usp=sharing

##

Agora o pr√≥ximo passo √© pensar em como seria o processo necess√°rio para chegar a solu√ß√£o, e chegamos a essa conclus√£o:

- `Passo 1`: Entrar no sistema (no nosso caso, entrar no link)
- `Passo 2`: Navegar at√© o local do relat√≥rio (entrar na pasta Exportar)
- `Passo 3`: Fazer o download do relat√≥rio
- `Passo 4`: Calcular os indicadores
- `Passo 5`: Entrar no email
- `Passo 6`: Enviar por e-mail o resultado

##

O `Passo 1` possui tr√™s etapas necess√°rias:
- [x] Abrir uma nova aba do navegador
- [x] Escrever o link no navegador
- [x] Apertar 'Enter'

Para resolver isso, vamos usar o pyautogui, uma biblioteca de automa√ß√£o de comandos do mouse e do teclado.

Comandos pyautogui: https://pyautogui.readthedocs.io/en/latest/quickstart.html

- Caso voc√™ j√° n√£o tenha o pyautogui instalado em seu computador, basta ir at√© uma c√©lula e escrever o comando: 
```
!pip install pyautogui
```
- E em seguida basta import√°-lo em seu projeto, mas como o pyautogui por si s√≥ n√£o reproduz caracteres especiais, importaremos tamb√©m o pyperclip que √© instalado junto com o pyautogui para realizar as c√≥pias de texto necess√°rias.
```
import pyautogui
import pyperclip
```
- Nosso c√≥digo:
![image](https://user-images.githubusercontent.com/54343955/182649181-449fe475-5240-4160-8f72-9fc9f0334167.png)

Agora podemos realizar os comandos necess√°rios para concluir o `Passo 1`:
- Como o pyautogui realiza v√°rias a√ß√µes rapidamente, o navegador n√£o consegue acompanhar os comandos, ent√£o o comando pyautogui.PAUSE = 1 faz com que seja realizado uma pausa de 1 segundo entre cada comando realizado. 
```
pyautogui.PAUSE = 1
```
- Agora precisamos abrir uma nova aba do navegador, para isso usamos o atalho "ctrl", "t" dentro do comando pyautogui.hotkey().
```
pyautogui.hotkey("ctrl", "t")
```
- Realizamos a c√≥pia do link fornecido utilizando o pyperclip.copy().
```
pyperclip.copy("https://drive.google.com/drive/folders/149xknr9JvrlEnhNWO49zPcw0PW5icxga?usp=sharing")
```
- Em seguida utilizamos novamente a fun√ß√£o pyautogui.hotkey() mas dessa vez com o atalho "ctrl", "v" que √© o atalho colar.
```
pyautogui.hotkey("ctrl", "v")
```
- Utilizamos o comando pyautogui.press() para pressionar a tecla "enter" e entrar no link.
```
pyautogui.press("enter")
```
- E por fim importaremos a biblioteca time para utilizar a fun√ß√£o time.sleep() e colocar o tempo desejado para que a p√°gina carregue por completo.
```
import time
```
```
time.sleep(5)
```
- Nosso c√≥digo:
![image](https://user-images.githubusercontent.com/54343955/182650723-312b98a0-e165-4e85-9adb-0e70989e9a27.png)
- Consideramos que o seu navegador ja esteja aberto para os comandos acima, mas caso queira abrir o programa do zero basta acrescentar ao inicio do c√≥digo:
```
# pyautogui.press("win")
# pyautogui.write("chrome")
# pyautogui.press("enter")
```

##

Para `Passo 2` ser√° necess√°rio clicar nas pastas desejadas, ent√£o um macete para descobrir a localiza√ß√£o do mouse s√£o os seguintes comandos:
```
time.sleep(5)
pyautogui.position()
```
- Com esse comando voc√™ ter√° 5 segundos para ficar com o mouse no local desejado e a posi√ß√£o ser√° mostrada no comando pyautogui.position()
- Lembrando que a posi√ß√£o varia para cada tipo de resolu√ß√£o de tela, e tamb√©m abas menores ou em tela cheia, ent√£o o comando utilizado nesse exemplo pode n√£o funcionar em seu computador e ser√° necess√°rio atualizar as posi√ß√µes de acordo com a sua situa√ß√£o.
- Com a posi√ß√£o do local do click descoberta, vamos agora utilizar o comando pyautogui.click("posi√ß√£o descoberta", clicks=2) para clicar duas vezes na pasta e tamb√©m o time.sleep(2) para o carregamento da p√°gina.
```
pyautogui.click(x=878, y=676, clicks=2)
time.sleep(2)
```
- Nosso c√≥digo:
![image](https://user-images.githubusercontent.com/54343955/182651410-4ecf2753-07d2-4666-9b7b-a737656b969f.png)

##

O `Passo 3` agora √© realizar o download do arquivo, para isso precisaremos descobrir:
- [x] A posi√ß√£o do arquivo
- [x] A posi√ß√£o do 'Mais A√ß√µes' (conhecido com 3 pontos)
- [x] A op√ß√£o de baixar (dentro dos 3 pontos)

E utilizar o pyautogui.click(x=, y=), junto a um .sleep() para dar tempo do arquivo baixar.
```
pyautogui.click(x=1000, y=919)
pyautogui.click(x=3323, y=406)
pyautogui.click(x=2748, y=1529)
time.sleep(5)
```
- Nosso c√≥digo:
![image](https://user-images.githubusercontent.com/54343955/182652294-c12c61e7-b016-4aa6-9a57-50ed84588a8d.png)

##

Agora o `Passo 4` √© calcular os indicadores, para isso precisaremos importar a biblioteca pandas que ja vem instalada com o Jupyter, e aproveitamos e usamos o 'as pd' para apelidar a biblioteca e facilitar o uso.
```
import pandas as pd
```
- E agora importaremos nossa tabela baixada do link
- Para isso armazenaremos ela dentro de uma vari√°vel com nome de sua escolha 
- Utilizaremos o comando pd.read_excel(r" ") informando o local exato em que o arquivo est√° localizado em seu computador (Varia de caso para caso)
- E usaremos um display() com a vari√°vel criada para mostrar a tabela na tela
```
tabela = pd.read_excel(r"C://Users/joaol/Downloads/Vendas - Dez.xlsx")
display(tabela)
```
- Com a tabela na tela, analisaremos seus dados e pegaremos os dados que precisamos, para isso usaremos os comandos a seguir para somar as colunas desejadas.
```
faturamento = tabela["Valor Final"].sum()
quantidade = tabela["Quantidade"].sum()
```
- Nosso c√≥digo:
![image](https://user-images.githubusercontent.com/54343955/182655110-49f3a7be-95f6-4820-b43f-a1e60d854d95.png)

##

Para o `Passo 5` vamos repetir alguns comandos j√° utilizados, mas dessa vez para abrir uma nova aba e ir at√© o gmail
```
pyautogui.hotkey("ctrl", "t")
pyperclip.copy("https://mail.google.com/mail/u/0/#inbox")
pyautogui.hotkey("ctrl", "v")
pyautogui.press("enter")
time.sleep(5)
```
- Nosso c√≥digo:
![image](https://user-images.githubusercontent.com/54343955/182655445-fd25d145-bd09-4e4d-b260-6c02d5f9da10.png)

## 

E enfim para o `Passo 6` iremos enviar por e-mail o resultado da nossa an√°lise, e para isso precisamos:
- [x] Clicar no + para escrever nova mensagem.
- [x] Escrever o email do destinat√°rio.
- [x] Precionar tab para selecionar o email.
- [x] Precionar tab novamente para mudar para o bloco descri√ß√£o.
- [x] Copiar a mensagem desejada.
- [x] Utilizar o comando de atalho para colar a mensagem.
- [x] Pressionar tab novamente para mudar de bloco.
```
pyautogui.click(x=40, y=173)
pyautogui.write("seugmail+diretoria@gmail.com")
pyautogui.press("tab")
pyautogui.press("tab")
pyperclip.copy("Relat√≥rio De Vendas")
pyautogui.hotkey("ctrl", "v")
pyautogui.press("tab")
```
- [x] Criar uma variavel texto formatada com os dados calculados no `Passo 4`
```texto = f"""
Prezados, bom dia

O faturamento de ontem foi de: R${faturamento:,.2f}
A quantidade de produtos foi de: {quantidade:,}

Abs
Leo"""
```
- [x] Copiar e colar o texto na mensagem do gmail e enviar para a diretoria.
```
pyperclip.copy(texto)
pyautogui.hotkey("ctrl", "v")
pyautogui.hotkey("ctrl", "enter")
```
- Nosso c√≥digo:
![image](https://user-images.githubusercontent.com/54343955/182661621-6621d51e-40ff-41f9-9af9-13ff4c07d3f1.png)

- PRONTO! AGORA √â S√ì IMPRESSIONAR O CHEFE üòÅ

## Desafio 01 Funcionando
![Automa√ß√£o de Sistemas e Processos com Python](https://user-images.githubusercontent.com/54343955/182669725-766218ed-2be4-4e1c-8cc3-183c767a784f.gif)

## Desafio 02

Para in√≠cio, nos deparamos com o seguinte desafio:

- `Desafio`: Voc√™ trabalha em uma empresa de telecom e tem clientes de v√°rios servi√ßos diferentes, entre os principais: internet e telefone.
O problema √© que, analisando o hist√≥rico dos clientes dos √∫ltimos anos, voc√™ percebeu que a empresa est√° com Churn de mais de 26% dos clientes.
Isso representa uma perda de milh√µes para a empresa.
O que a empresa precisa fazer para resolver isso?
- Base de Dados: https://drive.google.com/drive/folders/1T7D0BlWkNuy_MDpUHuBG44kT80EmRYIs?usp=sharing
- Link Original do Kaggle: https://www.kaggle.com/radmirzosimov/telecom-users-dataset

##

Agora o pr√≥ximo passo √© pensar em como seria o processo necess√°rio para chegar a solu√ß√£o, e chegamos a essa conclus√£o:

- `Passo 1`: Importar a base de dados
- `Passo 2`: Visualizar a base de dados
- `Passo 3`: Tratamento de dados (resolver os problemas da base de dados)
- `Passo 4`: An√°lise inicial dos dados (entender os cancelamentos)
- `Passo 5`: Descobrir o motivo dos cancelamentos
- `Passo 6`: Conclus√µes e A√ß√µes

##

O `Passo 1` possui apenas uma etapa necess√°ria:
- [x] Importar a base de dados

Para resolver isso, vamos usar o pandas, uma biblioteca para leitura e manipula√ß√£o de dados.

Comandos pandas: https://pandas.pydata.org/docs/
- A biblioteca pandas j√° vem instalada junto ao Jupyter.

Agora podemos realizar os comandos necess√°rios para concluir o `Passo 1`:
- Primeiramente importamos a biblioteca do pandas com o comando 'import pandas as pd'.
- Ap√≥s importar a biblioteca basta armazenar a sua base de dados dentro de uma vari√°vel.
- Nessa etapa utilizamos o atalho para o arquivo sem o caminho completo "telecom_users.csv" pois o arquivo estava localizado na mesma pasta em que o projeto est√°.
```
import pandas as pd

tabela = pd.read_csv("telecom_users.csv")
```
- Nosso c√≥digo:
![image](https://user-images.githubusercontent.com/54343955/182672808-2297d8a7-ba26-47b8-8822-5d009294277d.png)

##

Para `Passo 2` teremos 4 etapas:
- [x] Visualizar a base de dados.
- [x] Entender as informa√ß√µes que voc√™ tem dispon√≠vel.
- [x] Descobrir o problema da base de dados.
- [x] Excluir colunas in√∫teis (informa√ß√µes que n√£o te ajudam, te atrapalham).

Para isso devemos dar um display na tabela e verificar as informa√ß√µes.
```
display(tabela)
```
Agora que analisamos a tabela, percebemos que a coluna 'Unnamed' n√£o nos servir√° para nada, ent√£o teremos q excluir ela.
- Para excluir uma informa√ß√£o de uma tabela, devemos utilizar o comando tabela.drop() e informar um "nome" e um eixo.
- Para isso devemos saber que o "nome" pode ser o nome ou a linha da tabela, e o eixo utilizamos axis=o -> para o eixo da linha e axis=1 -> para o eixo da coluna.
```
tabela = tabela.drop("Unnamed: 0", axis=1))
```
- Nosso c√≥digo:
![image](https://user-images.githubusercontent.com/54343955/182673698-ca9e4d3f-cf9e-4ce6-a6ff-839e5e6c6161.png)

##

Para o `Passo 3` precisaremos tratar os dados e isso possui 3 etapas:
- [x] Resumir sua base de dados
- [x] Verificar se as informa√ß√µes s√£o tipo correto.
- [x] Eliminar informa√ß√µes vazias, podem ser colunas ou linhas.

Para resumir a base de dados utilizamos o comando print(tabela.info())
```
print(tabela.info())
```
- Notamos que a coluta 'Total Gasto' est√° sendo reconhecida como object(texto) mas ela √© do tipo float(com casas decimais)
- Precisaremos corrigi-la com o comando pd.to_numeric() para transform√°-la em n√∫meros e o metodo errors="coerce" para for√ßar o erro a virar n√∫mero.
```
tabela["TotalGasto"] = pd.to_numeric(tabela["TotalGasto"], errors="coerce")
```
Ap√≥s corrigir nosso erro deveremos eliminar qualquer informa√ß√£o vazia que n√£o te prejudique em sua base de dados.
- O comando dropna() exclui informa√ß√µes vazias, para isso deveremos informar o how="" e o axis.
- O axis j√° vimos acima, o how="" pode ser "all" para excluir a linha/coluna se todas as informa√ß√µes dela estiverem vazias ou "any" para excluir a linha/coluna
se qualquer informa√ß√£o dela estiver vazia.
- Excluindo tabelas completamentes vazias.
```
tabela = tabela.dropna(how="all", axis=1)
```
- Excluindo linhas com alguma coisa vazia.
```
tabela = tabela.dropna(how="any", axis=0)
```
- Nosso c√≥digo:
![image](https://user-images.githubusercontent.com/54343955/182674700-2d83aa66-5f34-4249-b54a-bd2c16bf1555.png)

##

Agora no `Passo 4` teremos a an√°lise inicial dos dados e nisso deveremos conferir os cancelamentos
- [x] como est√£o os cancelamentos? 26%

Analizaremos a coluna 'Churn' que s√£o os cancelamentos das pessoas e utilizaremos o comando .value_counts() para contar com precis√£o a ocorrencia de cancelamento.
- Tamb√©m existem outras fun√ß√µes como .sum(soma) / .average(media) / mean(mediana) / value_counts(quantidade) mas utilizaremos apenas o counts.
```
print(tabela["Churn"].value_counts())
```
- E tamb√©m podemos usar o m√©todo (normalize=True) para verificar a porcentagem (se for da sua prefer√™ncia √© poss√≠vel utilizar o comando .map("{:.1%}".format) para 
formatar a porcentagem.
```
print(tabela["Churn"].value_counts(normalize=True).map("{:.1%}".format))
```
- E com isso confirmamos os 26% de cancelamento.
- Nosso c√≥digo:
![image](https://user-images.githubusercontent.com/54343955/182674892-a8516bd9-d58c-4e27-977e-0bce8f708af0.png)

##

No `Passo 5` precisaremos descobrir o motivo dos cancelamentos e para isso transformaremos cada uma das colunas em gr√°ficos e analisaremos os dados.
- Para isso precisaremos instalar plotly, que √© um biblioteca de gr√°ficos.
- Caso voc√™ j√° n√£o tenha o plotly instalado em seu computador, basta ir at√© uma c√©lula e escrever o comando: 
```
!pip install plotly
```
- E em seguida basta import√°-lo em seu projeto, para isso vamos utilizar o comando:
```
import plotly.express as px
```
Para transformar todas as colunas de uma vez em gr√°fico, precisaremos utilizar o m√©todo 'for' e passar o seu par√¢metro dentro do x= a seguir.
- Iremos utilizar o comando px.histogram() para criar um gr√°fico do tipo histograma, e passar nele (nossa tabela, x="a coluna(a nossa est√° no 'for')", e a color="que √© a coluna em rela√ß√£o a outra")
- Existem outros tipos de gr√°fico como grafico de barra .bar / linha .line / histograma .histogram, mas s√≥ usaremos o histograma.
- Exemplo de gr√°ficos: https://plotly.com/python/histograms/
- E iremos exibir o gr√°fico
```
for coluna in tabela.columns:
    grafico = px.histogram(tabela, x=coluna, color="Churn")
    grafico.show()
```
- Nosso c√≥digo:
![image](https://user-images.githubusercontent.com/54343955/182675299-d1d239d9-352d-4ecc-8948-24c5a5abce58.png)

##

E por fim no `Passo 6` basta an√°lisar os dados e anotar suas Conclus√µes.
- `Conclus√µes`:

- [x] Clientes que est√£o h√° pouco tempo est√£o cancelando muito
- Pode estar fazendo alguma promo√ß√£o que d√° o primeiro m√™s de gra√ßa
- O inicio do servi√ßo pro cliente est√° sendo muito confuso
- A primeira experiencia pro cliente ta ruim
- Podemos criar incentivos nos primeiros m√™ses - primeiro ano mais barato

- [x] Boleto Eletronico tem muito mais cancelamento que as outras formas de pagamento
- Oferecer desconto nas outras formas de pagamento

- [x] Pessoas com contrato mensal tem muito mais chance de cancelar
- Desconto para pagar a anu√≠dade

- [x] Mais servi√ßos o cliente tem (suporte) menos ele cancela
- Pode oferecer servi√ßos extras quase de gra√ßa

- [x] Clientes com familia maior tem menos chance de cancelar
- 2¬∞ linha de gra√ßa ou desconto
- Nosso c√≥digo:
![image](https://user-images.githubusercontent.com/54343955/182675820-4e88375a-55a1-4aad-8966-26e43fd15004.png)

- PRONTO! AGORA √â S√ì IMPRESSIONAR O CHEFE üòÅ

## Desafio 02 Funcionando
![An√°lise de dados com Python](https://user-images.githubusercontent.com/54343955/182684440-1fa7ee89-8c16-4d18-bc06-dca9c7d5a770.gif)

## Desafio 03

Para in√≠cio, nos deparamos com o seguinte desafio:

- `Desafio`: Trabalhamos em uma importadora e o pre√ßo dos nossos produtos √© vinculado a cota√ß√£o de:
- D√≥lar
- Euro
- Ouro

Precisamos pegar na internet, de forma autom√°tica, a cota√ß√£o desses 3 itens e saber quanto devemos cobrar pelos nossos produtos, considerando uma margem de contribui√ß√£o que temos na nossa base de dados.
- Base de Dados: https://drive.google.com/drive/folders/1KmAdo593nD8J9QBaZxPOG1yxHZua4Rtv?usp=sharing

##

Agora o pr√≥ximo passo √© pensar em como seria o processo necess√°rio para chegar a solu√ß√£o, e chegamos a essa conclus√£o:

- `Passo 1`: Pegar a cota√ß√£o do d√≥lar
- `Passo 2`: Pegar a cota√ß√£o do euro
- `Passo 3`: Pegar a cota√ß√£o do ouro
- `Passo 4`: Atualizar a base de dados
- `Passo 5`: Recalcular os pre√ßos
- `Passo 6`: Exportar a base de dados

##

O `Passo 1` possui quatro etapas necess√°rias:
- [x] Abrir o navegador
- [x] Entrar no google
- [x] Pesquisar a cota√ß√£o do d√≥lar no google
- [x] Pegar a cota√ß√£o do d√≥lar

Para resolver isso, usaremos o selenium, uma biblioteca de automa√ß√£o de comandos web.

Comandos selenium: https://www.selenium.dev/documentation/ 

E iremos criar uma automa√ß√£o web:
- Importante: baixar o <a href="https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/">webdriver</a>
- Cada navegador tem seu pr√≥prio drive, no meu caso estou utilizando o edge.
- Para instalar o webdriver, basta copiar o execut√°vel baixado e colar na pasta em que seu anaconda estiver instalado.
- Para saber o local basta pesquisar por Anaconda Prompt em sua barra de pesquisa e iniciar o prompt, na primeira linha informar√° o local da pasta, no meu caso aparece:
![image](https://user-images.githubusercontent.com/54343955/182687259-f35e8858-b18f-4580-8ced-582e0fa3a5f7.png)


- Ap√≥s isso basta localizar a pasta Anaconda3 em seu computador e colar o execut√°vel dentro.
- Caso voc√™ j√° n√£o tenha o Selenium instalado em seu computador, basta ir at√© uma c√©lula do seu jupyter e escrever o comando: 
```
!pip install selenium
```
- E em seguida basta import√°-lo em seu projeto, e importaremos tamb√©m a fun√ß√£o keys para utilizar teclas de atalho na automa√ß√£o.
```
from selenium import webdriver
from selenium.webdriver.common.keys import Keys
```

Agora podemos realizar os comandos necess√°rios para concluir o `Passo 1`:
- Para abrir o navegador usaremos o comando 'navegador = webdriver.Edge()'
```
navegador = webdriver.Edge()
```
- Para entrar no google usaremos o comando 'navegador.get("") com o link do navegador'
```
navegador.get("https://www.google.com.br/")
```
- Para pesquisar a cota√ß√£o do d√≥lar, precisaremos primeiramente localizar a aba de escrever a pesquisa, para fazer isso precisaremos descobrir o 'xpath' que √© a localiza√ß√£o do item desejado na p√°gina.
- Para localizar o xpath do item (barra de pesquisa), precisaremos inspecionar a p√°gina com a tecla f12 e clicar na op√ß√£o de selecionar um item especifico da tela e inspecion√°-lo, ou usar o atalho 'ctrl'+'shift'+'c' para inspecionar direto.
- Ap√≥s selecionar a barra de pesquisa, ficar√° marcado um c√≥digo em azul no c√≥digo da p√°gina.
![image](https://user-images.githubusercontent.com/54343955/181826772-5ffe91be-11e0-47e7-95a6-df63f703442b.png)
- Ap√≥s localizar, basta clicar com o bot√£o direito e ir em c√≥pia -> copiar Xpath.
![image](https://user-images.githubusercontent.com/54343955/181827520-b1aa2a87-04a3-4c81-a18a-dc65048a1afd.png)
- Em seguida usaremos o comando .find_element() informando o xpath, e tamb√©m o comando send_keys() para enviar o texto desejado.
```
navegador.find_element('xpath','/html/body/div[1]/div[3]/form/div[1]/div[1]/div[1]/div/div[2]/input').send_keys("cotacao dolar")
```
- Agora pegaremos xpath do bot√£o pesquisar e utilizar o comando send_keys(Keys.ENTER).
```
navegador.find_element('xpath','/html/body/div[1]/div[3]/form/div[1]/div[1]/div[3]/center/input[1]').send_keys(Keys.ENTER)
```
- E por fim basta achar o xpath da cota√ß√£o do d√≥lar, mas dessa vez procuraremos um elemento em espec√≠fico no elemento.
- Basta inspecionar o valor da cota√ß√£o do d√≥lar e procurar o valor que precisamos, no nosso caso o 'data-value' e especific√°-lo dentro do comando .get_attribute().
![image](https://user-images.githubusercontent.com/54343955/182687932-71afd2e5-e15b-4bc1-8311-fdd8622d5099.png)

```
cotacao_dolar = navegador.find_element('xpath','//*[@id="knowledge-currency__updatable-data-column"]/div[1]/div[2]/span[1]').get_attribute('data-value')
```
- Nosso c√≥digo:
![2022-08-03_16h05_21-00 00 00 000-00 00 05 935](https://user-images.githubusercontent.com/54343955/182689453-bb7c5836-025e-4113-a3d5-30973b997d1e.gif)

##

Para `Passo 2` basta repetir o `Passo 1` mas dessa vez pesquisando a cota√ß√£o do euro.
```
navegador.get("https://www.google.com.br/")
navegador.find_element('xpath','/html/body/div[1]/div[3]/form/div[1]/div[1]/div[1]/div/div[2]/input').send_keys("cotacao euro") # como e qual o codigo /
navegador.find_element('xpath','/html/body/div[1]/div[3]/form/div[1]/div[1]/div[3]/center/input[1]').send_keys(Keys.ENTER)
cotacao_euro = navegador.find_element('xpath','//*[@id="knowledge-currency__updatable-data-column"]/div[1]/div[2]/span[1]').get_attribute('data-value')
```
- Nosso c√≥digo:
![2022-08-03_16h10_40-00 00 00 000-00 00 05 970](https://user-images.githubusercontent.com/54343955/182690350-297204e8-60fc-4d80-97eb-bbf918fa561f.gif)

##

Para o `Passo 3` precisaremos fazer quase o mesmo processo dos passos anteriores, mas dessa vez no site Melhor c√¢mbio.
```
navegador.get("https://www.melhorcambio.com/ouro-hoje#:~:text=O%20valor%20do%20grama%20do,em%20R%24%20292%2C87.")
cotacao_ouro = navegador.find_element('xpath','//*[@id="comercial"]').get_attribute('value')
```
Mas dessa vez o valor do ouro veio com a formata√ß√£o errada, ent√£o usaremos o .replace(",",".") para substituir a v√≠rgula por ponto.
```
cotacao_ouro = cotacao_ouro.replace(",",".")
```
E usaremos o .quit() para ap√≥s a an√°lise, a aba de pesquisa fechar automaticamente.
```
navegador.quit()
```
- Nosso c√≥digo:
![image](https://user-images.githubusercontent.com/54343955/182690696-2f8ab015-1263-42bc-90f2-a5a1d717bf02.png)

##

Agora o `Passo 4` basta importarmos nossa tabela com o pandas e analisar o que precisamos modificar e atualizar nela.
- Deixei o arquivo 'Produtos.xlsx' na mesma pasta do c√≥digo para facilitar.
```
import pandas as pd

tabela = pd.read_excel("Produtos.xlsx")
display(tabela)
```
- Nosso c√≥digo:
![image](https://user-images.githubusercontent.com/54343955/182690950-f757362b-24a8-447d-95c2-3ff8aaa42513.png)

##

Para o `Passo 5` teremos tr√™s passos:
- [x] Atualizar as cota√ß√µes com os dados obtidos.
- [x] Atualizar o pre√ßo de compra.
- [x] Atualizar o pre√ßo de venda.

Para atualizar as cota√ß√µes teremos que verificar todas as linhas e trocar a cota√ß√£o antiga pela nova cota√ß√£o adiquirida pela automa√ß√£o.
- Usaremos o comando a seguir:
```
tabela.loc[tabela["Moeda"]=="D√≥lar", "Cota√ß√£o"] = float(cotacao_dolar)
tabela.loc[tabela["Moeda"]=="Euro", "Cota√ß√£o"] = float(cotacao_euro)
tabela.loc[tabela["Moeda"]=="Ouro", "Cota√ß√£o"] = float(cotacao_ouro)
```
Atualizaremos o pre√ßo de compra, multiplicando a coluna "Pre√ßo original" com a coluna "Cota√ß√£o":
```
tabela["Pre√ßo de Compra"] = tabela["Pre√ßo Original"] * tabela["Cota√ß√£o"]
```
E atualizaremos o pre√ßo de venda, multiplicando a coluna "Pre√ßo de Compra" com a coluna "Margem":
```
tabela["Pre√ßo de Venda"] = tabela["Pre√ßo de Compra"] * tabela["Margem"]
```
- Nosso c√≥digo:
![image](https://user-images.githubusercontent.com/54343955/182691091-ef29c57b-f0fa-4500-b2d8-2d71c273b5a4.png)

## 

E enfim para o `Passo 6` iremos exportar nossa tabela.
- Nessa parte devemos ter cuidado, pois se exportar-mos a tabela com o mesmo nome da original a tabela original ser√° perdida, ent√£o daremos um novo nome a ela.
- E colocaremos o par√¢metro index=False para o arquivo n√£o ir com o indice para a planilha.
```
tabela.to_excel("Produtos Novo.xlsx", index=False)
```
- Nosso c√≥digo:
![image](https://user-images.githubusercontent.com/54343955/182691267-8369a177-a784-4ff9-9374-ffb15abff92c.png)

- PRONTO! AGORA √â S√ì IMPRESSIONAR O CHEFE üòÅ

## Desafio 03 Funcionando
![2022-08-03_16h27_01-00 00 00 000-00 00 39 305](https://user-images.githubusercontent.com/54343955/182693431-1313e7d4-d281-41d7-b410-e3e45d4aba75.gif)


## Desafio 04

Para in√≠cio, nos deparamos com o seguinte desafio:

- `Desafio`: Nosso desafio √© conseguir prever as vendas que vamos ter em determinado per√≠odo com base nos gastos em an√∫ncios nas 3 grandes redes que a empresa Hashtag investe: TV, Jornal e R√°dio.
- Base de Dados: https://drive.google.com/drive/folders/1o2lpxoi9heyQV1hIlsHXWSfDkBPtze-V?usp=sharing

##

Agora o pr√≥ximo passo √© pensar em como seria o processo necess√°rio para chegar a solu√ß√£o, e chegamos a essa conclus√£o:

- `Passo 1`: Entendimento do Desafio
- `Passo 2`: Entendimento da √Årea/Empresa
- `Passo 3`: Extra√ß√£o/Obten√ß√£o de Dados
- `Passo 4`: Ajuste de Dados (Tratamento/Limpeza)
- `Passo 5`: An√°lise Explorat√≥ria
- `Passo 6`: Modelagem + Algoritmos (Aqui que entra a Intelig√™ncia Artificial, se necess√°rio)
- `Passo 7`: Interpreta√ß√£o de Resultados

##

O `Passo 1` e `Passo 2` devemos refletir sobre onde queremos chegar ao longo do projeto, pois deveremos tomar varias decs√µes, se uma coisa ta boa ou ta ruim, se usa um recurso ou outro, etc.
- Imagine que voce fa√ßa uma precis√£o de vendas de 95% de precis√£o, parece bom, mas se fosse para a eficacia de um medicamento, talvez 95% n√£o estejam t√£o bom.
- Ent√£o isso nos levar√° a tomar as melhores decis√µes no projeto.

Para o `Passo 3` fazeremos a importa√ß√£o da base de dados.
- Para isso usaremos a biblioteca do pandas com o nosso arquivos 'advertising.csv' e daremos um display para exibi-la na tela.
- A biblioteca pandas j√° vem instalada junto ao Jupyter.
- Comandos pandas: https://pandas.pydata.org/docs/
```
import pandas as pd
tabela = pd.read_csv("advertising.csv")
display(tabela)
```
##

Agora o `Passo 4`, tratar a base de dados e deixar ela mais pr√°tica.
- Faremos o uso do m√©todo .info()
```
print(tabela.info())
```
- Analizamos a nossa tabela, por√©m ela j√° est√° correta e n√£o necessita altera√ß√µes.

##

Para o `Passo 5` faremos a an√°lise preliminar para tentar entender como as informa√ß√µes est√£o se comportando.
- Precisaremos fazer a utiliza√ß√£o de tr√™s bibliotecas:
- matplotlib -> Gr√°ficos
- seaborn -> Gr√°ficos
- scikit-learn -> IA
- Caso voc√™ j√° n√£o tenha as bibliotecas instaladas em seu computador, basta ir at√© uma c√©lular e digitar o comando:
```
# !pip install matplotlib
# !pip install seaborn
# !pip install scikit-learn
```

Ap√≥s isso importaremos nossas bibliotecas.
- Usaremos o comando a seguir:
```
import seaborn as sns
import matplotlib.pyplot as plt
```
Precisaremos descobrir a correla√ß√£o de cada item da nossa tabela, para isso usaremos o comando tabela.corr():
- Mas para melhorar a visualiza√ß√£o, transformaremos ela em um gr√°fico de mapa de calor utilizando o seaborn com o comando .heatmap.
```
sns.heatmap(tabela.corr(), cmap="Wistia", annot=True)
```
- Utilizamos tamb√©m o "Wistia" para melhorar as cores do gr√°fico e tamb√©m o annot=True para anotar os valores dentro do gr√°fico.
![image](https://user-images.githubusercontent.com/54343955/182047985-57e57a3e-a5bd-4a1c-8b4c-7c2beccdf1c6.png)

## 

Para o `Passo 6` criaremos nossa IA para realizar testes.
- Pegaremos nossa base de dados e dividiremos ela em dados de treino e em dados de teste.
- Ou seja, enviaremos dados de treino para a IA aprender, e dados de tespe para testar se a IA aprendeu.
- Dividiremos em dados de x e de y.
- y -> quem voc√™ quer prever. (vendas)
- x -> √© todo o resto. (quem voc√™ vai usar para fazer a previs√£o)
```
x = tabela[["TV", "Radio", "Jornal"]]
y = tabela["Vendas"]
```
- O pr√≥ximo passo √© dividir novamente nossa tabela em quatro partes para testar nossa IA, separando em dois o x e y.
- x_treino, x_teste, y_treino, y_teste
- Na pr√°tica ficaria assim:

![image](https://user-images.githubusercontent.com/54343955/182048614-e8675b41-8beb-4afb-b7cc-59dc32db5db5.png)
- Para fazer essa divis√£o utilizaremos um m√©todo do scikit-learn chamado train_test_split.

```
from sklearn.model_selection import train_test_split

x_treino, x_teste, y_treino, y_teste = train_test_split(x, y, test_size=0.3)
```
- O test_size-0.3 divide os dados de treino e os dados de teste em 30% teste e 70% treino.

Ap√≥s isso precisaremos escolher os modelos de IA que vamos usar, neste projeto utilizaremos dois modelos:
- Regress√£o Linear
- RandomForest (√Årvore de Decis√£o)

Para isso devemos:
- [x] importar os modelos de IA
```
from sklearn.linear_model import LinearRegression
from sklearn.ensemble import RandomForestRegressor
```
- [x] Criar a IA
```
modelo_regressaoLinear = LinearRegression()
modelo_arvoreDecisao = RandomForestRegressor()
```
- [x] Treinar a IA.
```
modelo_regressaoLinear.fit(x_treino, y_treino)
modelo_arvoreDecisao.fit(x_treino, y_treino)
```
Agora testaremos a previs√£o dos nossos modelos de IA, e decidiremos qual o melhor modelo.
- Vamos usar o R¬≤ que diz a % que o nosso modelo consegue explicar o que acontece.
- [x] Fazer previs√£o dos testes
```
previsao_regressaoLiner = modelo_regressaoLinear.predict(x_teste)
previsao_arvoreDecisao = modelo_arvoreDecisao.predict(x_teste)
```
- [x] Utilizar o R¬≤ para descobrir qual dos modelos teve a previs√£o mais pr√≥xima dos nossos testes. 
```
from sklearn.metrics import r2_score

print(r2_score(y_teste, previsao_regressaoLiner))
print(r2_score(y_teste, previsao_arvoreDecisao))
```
E com isso descobrimos que o modelo arvoreDecisao se comportou melhor com o nosso teste, com 94%.

![image](https://user-images.githubusercontent.com/54343955/182049382-cde9f884-f912-45ca-a872-114b8c63e905.png)

E para demonstrar melhor, podemos criar um gr√°fico para demonstrar visualmente como nossos modelos reagiram em rela√ß√£o aos nossos testes.
- [x] Cria√ß√£o do gr√°fico
```
tabela_auxiliar = pd.DataFrame()
tabela_auxiliar["y_teste"] = y_teste
tabela_auxiliar["arvore decisao"] = previsao_arvoreDecisao
tabela_auxiliar["regressao linear"] = previsao_regressaoLiner

plt.figure(figsize=(15,6))
sns.lineplot(data=tabela_auxiliar)
plt.show()
```
![image](https://user-images.githubusercontent.com/54343955/182049250-5615a1c7-78aa-4c58-afce-68f1c34554b9.png)

E por fim, para o `Passo 7` interpretaremos os resultados e aprenderemos a fazer as previs√µes.
- Para isso basta importar nossa tabela com valores que queremos testar as nossas vendas.
```
novos = pd.read_csv("novos.csv")
display(novos)
```
- E basta utilizar o modelo arvore de decis√£o com a fun√ß√£o .predict(), na nossa nova tabela, e teremos o resultado de nossos testes.
```
print(modelo_arvoreDecisao.predict(novos))
```
![image](https://user-images.githubusercontent.com/54343955/182049642-e380a07c-1d58-4e83-9cbf-e7796c98c5c1.png)


- PRONTO! AGORA √â S√ì IMPRESSIONAR O CHEFE üòÅ

## Desenvolvedores/Contribuintes :octocat:

| [<img src="https://avatars.githubusercontent.com/u/54343955?v=4" width=115><br><sub>Leonardo Cunha</sub>](https://github.com/Leocbm) |  [<img src="https://avatars.githubusercontent.com/u/54343955?v=4" width=115><br><sub>Leonardo Cunha</sub>](https://github.com/Leocbm) |  [<img src="https://avatars.githubusercontent.com/u/54343955?v=4" width=115><br><sub>Leonardo Cunha</sub>](https://github.com/Leocbm) |
| :---: | :---: | :---: 
